#include <combo.h>

#define AUDIO_HEAP_START  0x80600000
#define AUDIO_HEAP_SIZE   0x100000

#define FANFARE_AUDIOSEQ_SIZE   0x1000
#define FANFARE_AUDIOBANK_SIZE  0x4800
#define FANFARE_UNK_SIZE        0
#define BGM_AUDIOSEQ_SIZE       0xe000
#define BGM_AUDIOBANK_SIZE      0x4800
#define BGM_UNK_SIZE            0

/* Patch the audio heap */
PATCH_START 0x800b87c4
  lui t9,%HI(AUDIO_HEAP_START)
  addiu t9,%LO(AUDIO_HEAP_START)
PATCH_END

PATCH_START 0x8010a1b4
.int AUDIO_HEAP_SIZE - 0x100
PATCH_END

/* Fix a vanilla bug that can cause a crash with some custom songs */
PATCH_START 0x800c03bc
  move t6,t5
PATCH_END

/* Patch the audio setups */
.macro PATCH_AUDIO_SPEC i
/* Patch num notes & seq players & reverb */
PATCH_START 0x80104778 + (\i) * 0x38 + 0x05
.byte 28
.byte 4
.byte 0
.byte 0
.byte 2
PATCH_END

PATCH_START 0x80104778 + (\i) * 0x38 + 0x18
.int 0xe000
.int 0x4800
.int 0
.int 0x2000
.int 0x4800
.int 0
PATCH_END
.endm

PATCH_AUDIO_SPEC 0
PATCH_AUDIO_SPEC 1
PATCH_AUDIO_SPEC 2
PATCH_AUDIO_SPEC 3
PATCH_AUDIO_SPEC 4
PATCH_AUDIO_SPEC 5
PATCH_AUDIO_SPEC 6
PATCH_AUDIO_SPEC 7
PATCH_AUDIO_SPEC 8
PATCH_AUDIO_SPEC 9
PATCH_AUDIO_SPEC 10
PATCH_AUDIO_SPEC 11
PATCH_AUDIO_SPEC 12
PATCH_AUDIO_SPEC 13
PATCH_AUDIO_SPEC 14
PATCH_AUDIO_SPEC 15
PATCH_AUDIO_SPEC 16
PATCH_AUDIO_SPEC 17
